<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=self, camera=()">
    <meta name="referrer" content="strict-origin">

    <title>Howell Forge - Metal Parts Production</title>
    <meta name="description" content="Howell Forge specializes in high-quality metal parts production with precision and reliability. Custom solutions for various industries. Get a quote today.">

    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>

    <style>
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }
        .header {
            background-color: black;
            color: white;
            padding: 1rem;
            text-align: center;
        }
        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            padding: 1rem;
        }
        .main-content {
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            min-height: calc(100vh - 200px);
        }
        .footer {
            background-color: black;
            color: white;
            padding: 1rem;
            text-align: center;
            position: fixed;
            bottom: 0;
            width: 100%;
        }
        .nav-button {
            display: inline-block;
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            margin: 0 10px;
            border-radius: 4px;
            background-color: #555;
            cursor: pointer;
            border: none;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        .nav-button:hover { background-color: #666; transform: translateY(-1px); }
        .nav-button:active { transform: translateY(1px); }
        .nav-button:focus { outline: 2px solid #888; outline-offset: 2px; }
        .loading {
            text-align: center;
            padding: 2rem;
            font-size: 1.2rem;
            color: #666;
            animation: pulse 1.5s infinite;
        }
        .error-boundary {
            padding: 20px;
            text-align: center;
            background-color: #fff3f3;
            color: #cc0000;
            border-radius: 4px;
            margin: 20px;
        }

        /* ── USDC Payment Section ── */
        .payment-section {
            margin-top: 2rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, #0052ff11, #0052ff05);
            border: 1.5px solid #0052ff44;
            border-radius: 12px;
        }
        .payment-section h3 {
            margin: 0 0 0.4rem 0;
            color: #0033cc;
            font-size: 1.15rem;
        }
        .payment-section .network-badge {
            display: inline-block;
            background: #0052ff;
            color: white;
            font-size: 0.72rem;
            font-weight: bold;
            padding: 2px 8px;
            border-radius: 20px;
            margin-bottom: 1rem;
            letter-spacing: 0.05em;
        }
        .payment-layout {
            display: flex;
            gap: 1.5rem;
            align-items: flex-start;
            flex-wrap: wrap;
        }
        .payment-qr img {
            width: 130px;
            height: 130px;
            border: 3px solid #0052ff33;
            border-radius: 8px;
            display: block;
        }
        .payment-qr p {
            text-align: center;
            font-size: 0.7rem;
            color: #555;
            margin: 4px 0 0 0;
        }
        .payment-details {
            flex: 1;
            min-width: 200px;
        }
        .payment-details p {
            margin: 0 0 0.5rem 0;
            font-size: 0.9rem;
            color: #333;
        }
        .address-box {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #fff;
            border: 1px solid #cce0ff;
            border-radius: 6px;
            padding: 8px 12px;
            margin: 0.5rem 0;
        }
        .address-box code {
            font-size: 0.75rem;
            color: #0033cc;
            word-break: break-all;
            flex: 1;
        }
        .copy-btn {
            background: #0052ff;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 10px;
            font-size: 0.75rem;
            cursor: pointer;
            white-space: nowrap;
            transition: background 0.2s;
        }
        .copy-btn:hover { background: #0040cc; }
        .copy-btn.copied { background: #28a745; }
        .payment-note {
            font-size: 0.78rem;
            color: #666;
            margin-top: 0.75rem;
            padding: 8px 10px;
            background: #fffbe6;
            border-left: 3px solid #f0ad00;
            border-radius: 0 4px 4px 0;
        }

        /* ── Web3 Wallet Section ── */
        .wallet-section {
            text-align: center;
            margin: 1.5rem 0 0 0;
            padding: 1rem;
            background-color: #f5f5f5;
            border-radius: 8px;
        }
        .wallet-option {
            background-color: #4CAF50;
            color: white;
            padding: 10px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 15px;
        }
        .wallet-option:hover { background-color: #45a049; }
        .wallet-option:disabled { background-color: #ccc; cursor: not-allowed; }
        .wallet-option.metamask { background-color: #f6851b; }
        .wallet-option.metamask:hover { background-color: #e67e22; }

        @media (prefers-reduced-motion: reduce) {
            .nav-button, .loading { transition: none; animation: none; }
        }
        @media (max-width: 600px) {
            .payment-layout { flex-direction: column; }
            .payment-qr img { width: 100px; height: 100px; }
        }
    </style>
</head>
<body>
    <div id="root">Loading...</div>

    <script type="text/babel">
        const BUSINESS_WALLET = "0x62eF356e555BCb06E4aD3328367df9e2d9d74168";
        const QR_URL = `https://api.qrserver.com/v1/create-qr-code/?size=130x130&data=${BUSINESS_WALLET}`;

        class ErrorBoundary extends React.Component {
            constructor(props) { super(props); this.state = { hasError: false, error: null }; }
            static getDerivedStateFromError(error) { return { hasError: true, error }; }
            componentDidCatch(error, info) { console.error('Error:', error, info); }
            render() {
                if (this.state.hasError) return (
                    <div className="error-boundary">
                        <h3>Something went wrong</h3>
                        <p>{this.state.error?.message}</p>
                        <button onClick={() => window.location.reload()}>Refresh</button>
                    </div>
                );
                return this.props.children;
            }
        }

        const App = () => {
            const [page, setPage] = React.useState('home');
            const [account, setAccount] = React.useState(null);
            const [isConnecting, setIsConnecting] = React.useState(false);
            const [error, setError] = React.useState(null);
            const [web3, setWeb3] = React.useState(null);
            const [providerType, setProviderType] = React.useState(null);
            const [copied, setCopied] = React.useState(false);

            React.useEffect(() => {
                if (window.ethereum) {
                    const w = new Web3(window.ethereum);
                    setWeb3(w);
                    setProviderType(window.ethereum.isMetaMask ? 'MetaMask' : window.ethereum.isBraveWallet ? 'Brave' : 'Wallet');
                } else if (window.web3) {
                    setWeb3(new Web3(window.web3.currentProvider));
                    setProviderType('Legacy');
                }
            }, []);

            const copyAddress = () => {
                navigator.clipboard.writeText(BUSINESS_WALLET).then(() => {
                    setCopied(true);
                    setTimeout(() => setCopied(false), 2000);
                });
            };

            const connectWallet = async () => {
                if (!web3) { setError('Please install MetaMask or use Brave Browser'); return; }
                setIsConnecting(true);
                setError(null);
                try {
                    const accounts = await web3.eth.requestAccounts();
                    if (!accounts?.length) throw new Error('No accounts found. Please unlock your wallet.');
                    setAccount(accounts[0]);
                    if (window.ethereum) {
                        window.ethereum.on('accountsChanged', a => a?.length ? setAccount(a[0]) : setAccount(null));
                        window.ethereum.on('chainChanged', () => window.location.reload());
                    }
                } catch (err) {
                    setError(err.code === 4001 ? 'Connection rejected.' : err.message || 'Failed to connect');
                } finally {
                    setIsConnecting(false);
                }
            };

            const UsdcPaymentSection = () => (
                <div className="payment-section">
                    <h3>Pay with USDC</h3>
                    <span className="network-badge">BASE NETWORK</span>
                    <div className="payment-layout">
                        <div className="payment-qr">
                            <img src={QR_URL} alt="Scan to pay with USDC on Base" />
                            <p>Scan to pay</p>
                        </div>
                        <div className="payment-details">
                            <p><strong>Send USDC to this address on Base:</strong></p>
                            <div className="address-box">
                                <code>{BUSINESS_WALLET}</code>
                                <button
                                    className={`copy-btn${copied ? ' copied' : ''}`}
                                    onClick={copyAddress}
                                >
                                    {copied ? '✓ Copied' : 'Copy'}
                                </button>
                            </div>
                            <p style={{fontSize:'0.85rem', color:'#444', marginTop:'0.75rem'}}>
                                <strong>Token:</strong> USDC &nbsp;|&nbsp;
                                <strong>Network:</strong> Base (Coinbase L2)
                            </p>
                            <div className="payment-note">
                                ⚠️ Only send <strong>USDC on the Base network</strong>. Sending other tokens or using a different network may result in permanent loss of funds.
                            </div>
                        </div>
                    </div>
                </div>
            );

            const WalletSection = () => {
                const shortAddr = account ? `${account.slice(0,6)}...${account.slice(-4)}` : '';
                return (
                    <div className="wallet-section">
                        <p style={{marginBottom:'0.75rem', color:'#444'}}>
                            Or connect your Web3 wallet to pay directly from your browser.
                        </p>
                        {error && <p style={{color:'#cc0000', fontSize:'0.85rem', marginBottom:'0.5rem'}}>{error}</p>}
                        <button
                            className={`wallet-option${providerType === 'MetaMask' ? ' metamask' : ''}`}
                            onClick={connectWallet}
                            disabled={isConnecting || !web3}
                        >
                            {isConnecting ? 'Connecting...' : account ? `✓ Connected: ${shortAddr}` : !web3 ? 'Install Web3 Wallet' : `Connect ${providerType || 'Wallet'}`}
                        </button>
                    </div>
                );
            };

            function Header() {
                return (
                    <div className="header">
                        <h1>Howell Forge</h1>
                        <div className="nav-buttons">
                            <button className="nav-button" onClick={() => setPage('home')}>Home</button>
                            <button className="nav-button" onClick={() => setPage('about')}>About</button>
                            <button className="nav-button" onClick={() => setPage('contact')}>Contact</button>
                        </div>
                    </div>
                );
            }

            function MainContent() {
                return (
                    <div className="main-content">
                        {page === 'home' && (
                            <>
                                <h2>Welcome to Howell Forge</h2>
                                <p>We specialize in high-quality metal parts production with a focus on precision and reliability.</p>
                                <UsdcPaymentSection />
                                <WalletSection />
                            </>
                        )}
                        {page === 'about' && (
                            <>
                                <h2>About Us</h2>
                                <p>At Howell Forge, we combine traditional craftsmanship with modern technology to create exceptional metal parts. Our commitment to quality and precision ensures that each piece meets the highest standards.</p>
                                <p>With years of experience in metal parts production, we have developed expertise in creating custom solutions for various industries.</p>
                            </>
                        )}
                        {page === 'contact' && (
                            <>
                                <h2>Contact Us</h2>
                                <p>We're here to help with your metal parts production needs.</p>
                                <p>Email: <a href="mailto:chrishowell@howell-forge.com">chrishowell@howell-forge.com</a></p>
                                <p>Business Hours: Monday - Friday, 9:00 AM - 5:00 PM EST</p>
                                <p>Please include project details in your email for a faster response.</p>
                            </>
                        )}
                    </div>
                );
            }

            return (
                <ErrorBoundary>
                    <div>
                        <Header />
                        <MainContent />
                        <div className="footer">&copy; 2024 Howell Forge. All rights reserved.</div>
                    </div>
                </ErrorBoundary>
            );
        };

        ReactDOM.render(
            <ErrorBoundary><App /></ErrorBoundary>,
            document.getElementById('root')
        );
    </script>
</body>
</html>
